# 📊 Excel导出功能使用指南

## 功能概述

新的Excel导出功能让您可以：
- ✅ 选择要导出的数据类型
- ✅ 选择时间范围
- ✅ 导出为Excel文件（.xlsx）
- ✅ 可用Excel、WPS等软件打开

---

## 🚀 如何使用

### 第1步：打开导出界面

点击顶部导航栏的 **绿色"导出Excel"** 按钮

### 第2步：选择数据类型

从下拉框选择要导出的内容：

| 选项 | 说明 | 包含内容 |
|------|------|---------|
| 📝 发票记录 | 推荐 | 所有发票的完整信息 |
| 📦 商品资料 | | 商品、价格、库存 |
| 📊 库存记录 | | 所有进出库历史 |
| 💰 财务记录 | | 收入支出记录 |
| 👥 客户资料 | | 客户联系信息 |
| 🏢 供应商资料 | | 供应商联系信息 |
| 📅 活动记录 | | 活动、预算、利润 |
| 📚 完整数据 | | 所有上述数据（多个工作表）|

### 第3步：选择时间范围

6个快捷按钮：

```
┌──────────┬──────────┬──────────┐
│   全部   │   今天   │ 最近7天  │
├──────────┼──────────┼──────────┤
│  本月 ★  │   本年   │  自定义  │
└──────────┴──────────┴──────────┘
```

**时间范围说明：**
- **全部** - 导出所有数据，不限时间
- **今天** - 只导出今天的数据
- **最近7天** - 导出过去7天
- **本月** - 当前月份（默认，推荐）
- **本年** - 当前年份
- **自定义** - 自己选择开始和结束日期

### 第4步：导出

点击 **"导出Excel"** 按钮

---

## 📄 Excel文件内容

### 发票记录工作表

**列名（按顺序）：**
| 列 | 说明 | 示例 |
|----|------|------|
| 发票号 | 发票编号 | INV202410-001 |
| 日期 | 开单时间 | 2024-10-15 10:30 |
| 客户 | 客户名称 | XX公司 |
| 电话 | 客户电话 | 012-3456789 |
| 商品数量 | 商品种类 | 3 |
| 小计 | 商品总额 | 1200.00 |
| 折扣 | 整单折扣 | 50.00 |
| 邮费 | 运费 | 10.00 |
| 其他费用 | 附加费用 | 5.00 |
| 税费 | SST税费 | 69.90 |
| 总金额 | 应付总额 | 1234.90 |
| 已付金额 | 已收款 | 1234.90 |
| 待付金额 | 待收款 | 0.00 |
| 付款状态 | 状态 | 已付清 |
| 付款方式 | 收款方式 | Touch 'n Go |
| 参考号 | 交易号 | TNG123456 |
| 备注 | 说明 | - |
| 开单人 | 操作员 | 张三 |

**特点：**
- 每行一张发票
- 完整的财务信息
- 便于统计分析
- 可用Excel做透视表

### 商品资料工作表

| SKU | 商品名称 | 分类 | 单位 | 当前库存 | 预警值 | 成本价 | 销售价 | 库存价值 | 条形码 | 供应商 | 创建时间 |
|-----|---------|------|------|---------|--------|--------|--------|---------|--------|--------|---------|
| ... | ... | ... | ... | ... | ... | ... | ... | ... | ... | ... | ... |

### 库存记录工作表

| 时间 | 商品 | 类型 | 数量 | 变动前库存 | 变动后库存 | 关联类型 | 备注 | 操作人 |
|------|------|------|------|-----------|-----------|---------|------|--------|
| ... | ... | 入库/出库 | ... | ... | ... | ... | ... | ... |

### 财务记录工作表

| 日期 | 类型 | 分类 | 金额 | 描述 | 操作人 |
|------|------|------|------|------|--------|
| ... | 收入/支出 | ... | ... | ... | ... |

### 客户资料、供应商资料、活动记录

各有对应的列，包含完整信息。

---

## 🎯 实际应用场景

### 场景1：月度财务报表

```
目的：导出本月所有发票做账

操作：
1. 点击"导出Excel"
2. 数据类型：📝 发票记录
3. 时间范围：本月
4. 点击"导出Excel"

结果：
→ 下载文件：半亩天光_发票记录_20241015_143000.xlsx
→ 打开Excel查看本月所有发票
→ 可以做透视表、图表分析
```

### 场景2：库存盘点

```
目的：导出所有商品做盘点

操作：
1. 点击"导出Excel"
2. 数据类型：📦 商品资料
3. 时间范围：全部（商品不受时间限制）
4. 点击"导出Excel"

结果：
→ 下载所有商品列表
→ 打印出来做盘点
→ 核对实际库存
```

### 场景3：特定时期销售分析

```
目的：分析国庆假期销售

操作：
1. 点击"导出Excel"
2. 数据类型：📝 发票记录
3. 时间范围：自定义
   开始：2024-10-01
   结束：2024-10-07
4. 点击"导出Excel"

结果：
→ 导出国庆期间所有发票
→ 分析销售情况
→ 了解热销商品
```

### 场景4：年度财务报告

```
目的：准备年度财务数据

操作：
1. 点击"导出Excel"
2. 数据类型：📚 完整数据
3. 时间范围：本年
4. 点击"导出Excel"

结果：
→ 导出包含7个工作表的Excel文件
→ 发票、库存、财务、商品等全部数据
→ 交给会计做账
```

### 场景5：客户资料备份

```
目的：导出客户资料

操作：
1. 点击"导出Excel"
2. 数据类型：👥 客户资料
3. 时间范围：全部
4. 点击"导出Excel"

结果：
→ 导出所有客户信息
→ 可导入CRM系统
→ 可做客户分析
```

---

## 📊 Excel文件特点

### 文件命名

**格式：** `半亩天光_数据类型_日期时间.xlsx`

**示例：**
- `半亩天光_发票记录_20241015_143000.xlsx`
- `半亩天光_商品资料_20241015_150530.xlsx`
- `半亩天光_完整数据_20241015_160000.xlsx`

### 工作表结构

**单一数据导出：**
- 1个工作表
- 表名：发票记录、商品资料等

**完整数据导出：**
- 7个工作表：
  1. 发票记录
  2. 商品资料
  3. 库存记录
  4. 财务记录
  5. 客户资料
  6. 供应商资料
  7. 活动记录

### 数据格式

**数字：**
- 金额：直接数字格式（1234.56）
- 便于Excel计算、求和

**日期：**
- 标准格式：yyyy-MM-dd HH:mm
- 可排序、筛选

**文本：**
- UTF-8编码
- 支持中文
- 不会乱码

---

## 💡 高级用法

### Excel中的数据分析

**导出发票后可以：**
```
1. 透视表分析
   - 按客户统计销售额
   - 按月份统计趋势
   - 按付款方式分类

2. 图表制作
   - 销售趋势线图
   - 客户销售饼图
   - 付款方式柱状图

3. 筛选排序
   - 筛选特定客户
   - 按金额排序
   - 查找未付款订单

4. 公式计算
   - 计算总收入
   - 计算平均客单价
   - 计算收款率
```

### 数据导入其他系统

**用途：**
- 导入会计软件
- 导入CRM系统
- 提供给税务审计
- 银行对账

---

## ⚙️ 智能过滤

### 时间过滤规则

**受时间限制的数据：**
- ✅ 发票记录 - 按创建时间
- ✅ 库存记录 - 按操作时间
- ✅ 财务记录 - 按记录日期
- ✅ 活动记录 - 按活动开始/结束时间

**不受时间限制的数据：**
- ✅ 商品资料 - 导出全部
- ✅ 客户资料 - 导出全部
- ✅ 供应商资料 - 导出全部

### 自动排除

**发票导出：**
- ❌ 自动排除已作废的发票
- ✅ 只导出有效发票
- ✅ 确保数据准确性

---

## 📋 导出清单对比

### 之前（JSON导出）

```
优点：
✅ 可以导入恢复数据

缺点：
❌ 不能直接查看
❌ 不能用Excel分析
❌ 不能选择时间范围
❌ 不能选择数据类型
```

### 现在（Excel导出）

```
优点：
✅ 直接用Excel打开
✅ 可以分析、图表
✅ 选择时间范围
✅ 选择数据类型
✅ 专业的报表格式

注意：
⚠️ Excel是单向导出
⚠️ 不能导入恢复
⚠️ 备份仍需用"导入数据"的JSON格式
```

---

## 🔄 备份 vs 导出

### JSON备份（导入数据按钮）

**用途：** 数据备份和恢复
```
导出 → JSON文件 → 可导入恢复
适合：定期备份、系统迁移
```

### Excel导出（导出Excel按钮）

**用途：** 数据分析和报表
```
导出 → Excel文件 → 分析、打印
适合：财务报表、数据分析
```

**建议：**
- 📅 每周JSON备份（数据安全）
- 📊 每月Excel导出（财务分析）

---

## 🎨 界面说明

### 导出模态框

```
┌──────────────────────────────────────┐
│ 📄 导出Excel数据              ✕     │
├──────────────────────────────────────┤
│                                      │
│ 导出数据类型                         │
│ [📝 发票记录（推荐）        ▼]      │
│                                      │
│ 时间范围                             │
│ ┌───────┬───────┬─────────┐        │
│ │ 全部  │ 今天  │ 最近7天 │        │
│ ├───────┼───────┼─────────┤        │
│ │ 本月★ │ 本年  │ 自定义  │        │
│ └───────┴───────┴─────────┘        │
│                                      │
│ 💡 说明：                            │
│ • Excel文件可用Microsoft Excel打开   │
│ • 发票、库存、财务会按时间筛选        │
│ • 已作废的发票不会导出               │
│ • "完整数据"会生成多个工作表         │
│                                      │
│          [取消]  [导出Excel]         │
└──────────────────────────────────────┘
```

### 自定义时间范围

```
选择"自定义"后显示：

开始日期              结束日期
┌──────────┐         ┌──────────┐
│2024-10-01│         │2024-10-15│
└──────────┘         └──────────┘
```

---

## 📁 导出文件示例

### 文件名格式

```
半亩天光_发票记录_20241015_143000.xlsx
│      │   │      │        └── 时间（14:30:00）
│      │   │      └─────────── 日期（2024-10-15）
│      │   └────────────────── 数据类型
│      └────────────────────── 公司名称
└───────────────────────────── 固定前缀
```

### 导出示例

**示例1：本月发票**
```
文件名：半亩天光_发票记录_20241015_143000.xlsx

内容：
- 工作表：发票记录
- 行数：本月所有发票（如25行）
- 列数：18列（完整信息）
```

**示例2：完整数据**
```
文件名：半亩天光_完整数据_20241015_150000.xlsx

内容：
- 工作表1：发票记录（100行）
- 工作表2：商品资料（50行）
- 工作表3：库存记录（200行）
- 工作表4：财务记录（80行）
- 工作表5：客户资料（30行）
- 工作表6：供应商资料（10行）
- 工作表7：活动记录（15行）
```

---

## 💼 实用技巧

### 1. 月度财务报表

```
导出：本月发票记录
Excel操作：
1. 插入透视表
2. 行：客户
3. 值：总金额（求和）
4. 生成客户销售排名
```

### 2. 库存分析

```
导出：商品资料
Excel操作：
1. 筛选：库存价值 > 1000
2. 排序：按库存价值降序
3. 找出库存占用资金最多的商品
```

### 3. 收款跟进

```
导出：本月发票记录
Excel操作：
1. 筛选：付款状态 = 未付款
2. 筛选：付款状态 = 部分付款
3. 得到需要跟进的客户清单
```

### 4. 销售趋势

```
导出：过去一年发票
Excel操作：
1. 透视表：行=月份，值=总金额
2. 插入折线图
3. 查看全年销售趋势
```

---

## 🚀 立即体验

系统正在运行：**http://localhost:3004/**

**测试导出：**

1. **快速导出本月发票**
   ```
   → 点击顶部"导出Excel"（绿色按钮）
   → 默认选择：发票记录 + 本月
   → 点击"导出Excel"
   → 文件自动下载 ✅
   → 用Excel打开查看
   ```

2. **导出完整数据**
   ```
   → 点击"导出Excel"
   → 选择：📚 完整数据
   → 时间范围：本年
   → 导出
   → 得到包含7个工作表的文件 ✅
   ```

3. **自定义时间**
   ```
   → 点击"导出Excel"
   → 选择：发票记录
   → 时间范围：自定义
   → 设置起止日期
   → 导出指定期间数据 ✅
   ```

---

## 📊 数据应用

### 会计做账

```
导出：本月发票 + 本月财务记录
用于：
- 记账凭证
- 税务申报
- 利润核算
```

### 业绩分析

```
导出：过去3个月发票
用于：
- 销售趋势分析
- 客户贡献度
- 商品销量排名
```

### 库存管理

```
导出：商品资料 + 库存记录
用于：
- 盘点对账
- 周转率分析
- 采购计划
```

---

## 💡 注意事项

**数据准确性：**
- ✅ 自动排除已作废发票
- ✅ 实时数据（导出时的最新状态）
- ✅ 完整字段（不遗漏）

**时间范围：**
- 商品、客户、供应商：导出全部（不受时间限制）
- 发票、库存、财务、活动：按选择的时间范围过滤

**文件格式：**
- .xlsx格式（Excel 2007及更高版本）
- 兼容WPS、Google Sheets等
- 中文不会乱码

---

**现在可以专业地导出和分析您的业务数据了！** 📊✨

**温馨提示：** 导出Excel用于分析，JSON备份用于恢复，两者结合使用最佳！

