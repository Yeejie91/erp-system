# 📝 开单流程完整指南

## 新版本特性

✅ **界面化选项** - 不再弹窗，所有选项在表单中
✅ **付款选项** - 勾选框控制是否收款
✅ **快速付款按钮** - 全额、一半、自定义
✅ **实时计算** - 即时显示剩余待付金额
✅ **自动打印** - 默认提交后自动打印

---

## 完整开单流程

### 第1步：选择客户
```
- 从下拉框选择客户
- 或点击"新增客户"快速添加
```

### 第2步：添加商品
```
1. 选择商品（下拉框显示价格和库存）
2. 自动显示详细信息卡片：
   - 单价（可修改）
   - 数量
   - 折扣%
   - 金额预览（实时计算）
3. 点击"添加到清单"
4. 重复以上步骤添加更多商品
```

### 第3步：设置费用
```
商品明细下方自动显示：
- 小计
- 整单折扣（可输入）
- 邮费/运费（可输入）
- 其他费用（可输入）
- 税费（自动计算）
- 总计（醒目显示）
```

### 第4步：设置付款选项 💰

#### 选项A：客户现金付款

**勾选"客户现在付款" ✓**

显示快速按钮：
```
┌─────────────────────────────────┐
│ [全额付款 RM1,234.56]           │
│ [付一半 RM617.28]               │
│                                 │
│ 或输入自定义金额:               │
│ [_________] RM                  │
│                                 │
│ 总金额:    RM1,234.56          │
│ 付款金额:  RM1,234.56  (绿色)  │
│ 剩余待付:  RM0.00              │
└─────────────────────────────────┘
```

**快速操作：**
- 点击"全额付款" → 自动填入全额 ✅
- 点击"付一半" → 自动填入一半金额
- 输入框 → 自定义任意金额

#### 选项B：客户挂账

**不勾选"客户现在付款" ✗**
- 发票状态将为"未付款"
- 稍后在列表中记录付款

### 第5步：打印选项 🖨️

**默认勾选"提交后立即打印发票" ✓**
- 创建成功后自动弹出打印预览
- 直接打印给客户

**取消勾选 ✗**
- 不打印
- 稍后在列表中打印

### 第6步：提交

点击"创建发票"按钮 → 完成！

---

## 📊 不同场景的操作

### 场景1：现金全款客户（最常见）

```
操作：
✓ 勾选"客户现在付款"
  → 点击"全额付款"按钮
✓ 勾选"提交后立即打印"
点击"创建发票"

结果：
✅ 发票创建
✅ 库存扣减
✅ 付款状态：已付清
✅ 自动打印收据
```

**耗时：** 3秒

---

### 场景2：部分付款客户

```
操作：
✓ 勾选"客户现在付款"
  → 输入框填入"500"（总额RM1,000）
  → 看到：剩余待付 RM500（红色）
✓ 勾选"提交后立即打印"
点击"创建发票"

结果：
✅ 发票创建
✅ 库存扣减
✅ 付款状态：部分付款
✅ 已付：RM500
✅ 待付：RM500
✅ 自动打印收据（显示部分付款）
```

**提醒：** 可在报表中追踪待收款

---

### 场景3：月结客户（挂账）

```
操作：
✗ 不勾选"客户现在付款"
✓ 勾选"提交后立即打印"
点击"创建发票"

结果：
✅ 发票创建
✅ 库存扣减
✅ 付款状态：未付款
✅ 自动打印收据（显示未付款）
```

**提醒：** 月底统一结算

---

### 场景4：电子单据（不打印）

```
操作：
✗ 不勾选"客户现在付款"
✗ 不勾选"提交后立即打印"
点击"创建发票"

结果：
✅ 发票创建
✅ 库存扣减
✅ 付款状态：未付款
✅ 不打印
```

**适用：** 线上订单、电子发票

---

## 💡 界面优势

### 之前（弹窗方式）
```
❌ 连续3个弹窗
❌ 必须逐个确认
❌ 不能修改
❌ 容易点错
```

### 现在（界面选项）
```
✅ 所有选项一目了然
✅ 可以随时修改
✅ 快速按钮方便
✅ 实时预览结果
```

---

## 🎯 快捷操作

### 最快速的全款现金开单

```
1. 选客户
2. 加商品
3. ✓ 客户现在付款（自动全额）
4. ✓ 提交后立即打印（默认勾选）
5. 创建发票
→ 完成！自动打印
```

**只需5步，2个勾选框已默认设置好！**

---

## 📋 实时预览功能

### 付款金额预览

当勾选"客户现在付款"并输入金额后，实时显示：

```
总金额:    RM1,234.56
付款金额:  RM500.00  ← 绿色
剩余待付:  RM734.56  ← 红色（如有余额）
```

- 绿色 = 已收款
- 红色 = 待收款
- 一眼看清收款情况

---

## 🖨️ 打印内容

打印的收据会根据付款情况自动显示：

**已付清：**
```
付款状态: ✓ 已付清 PAID
已付金额: RM1,234.56
```

**部分付款：**
```
付款状态: 部分付款 PARTIAL
已付金额: RM500.00
待付金额: RM734.56
```

**未付款：**
```
付款状态: 未付款 UNPAID
待付金额: RM1,234.56
```

---

## 🚀 立即体验

系统正在运行：**http://localhost:3004/**

**体验新流程：**

1. 进入"开单管理" → "新建发票"
2. 填写发票信息
3. 滚动到底部，看到两个新增的选项卡：
   - 💰 **付款选项**（蓝色背景）
   - 🖨️ **打印选项**（灰色背景）
4. 勾选"客户现在付款"
5. 点击"全额付款"按钮 → 看到实时预览 ✅
6. "提交后立即打印"默认已勾选 ✅
7. 点击"创建发票"
8. 成功提示后自动弹出打印预览 🖨️

**界面操作更直观！** 🎊
